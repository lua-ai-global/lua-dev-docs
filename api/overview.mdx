---
title: "API Overview"
description: "Complete API reference for building Lua AI skills"
---

## Available APIs

Lua CLI v3.0.0 provides a comprehensive set of APIs for building AI agents:

<CardGroup cols={2}>
  <Card
    title="Core Classes"
    icon="puzzle-piece"
  >
    **LuaAgent, LuaSkill, LuaTool** - Agent configuration and building blocks
  </Card>
  <Card
    title="Automation"
    icon="clock"
  >
    **LuaJob, LuaWebhook** - Scheduled tasks and HTTP endpoints
  </Card>
  <Card
    title="Message Processing"
    icon="filter"
  >
    **PreProcessor, PostProcessor** - Filter and format messages
  </Card>
  <Card
    title="Platform APIs"
    icon="server"
  >
    **AI, User, Data, Products, Baskets, Orders, Jobs** - Built-in services
  </Card>
  <Card
    title="Environment"
    icon="key"
  >
    **env()** - Secure configuration management
  </Card>
  <Card
    title="Type Definitions"
    icon="code"
  >
    Full TypeScript support with autocomplete
  </Card>
</CardGroup>

<Note>
**New in v3.0.0:** LuaAgent, LuaJob, LuaWebhook, PreProcessor, PostProcessor, and Jobs API for comprehensive agent development.
</Note>

## Installation

<CodeGroup>

```bash npm
npm install lua-cli zod
```

```bash yarn
yarn add lua-cli zod
```

```bash pnpm
pnpm add lua-cli zod
```

</CodeGroup>

<Note>
`zod` is a peer dependency required for schema validation
</Note>

## Quick Start

### Import APIs

```typescript
// Core classes (v3.0.0)
import { 
  LuaAgent, 
  LuaSkill, 
  LuaTool, 
  LuaWebhook, 
  LuaJob,
  PreProcessor,
  PostProcessor
} from 'lua-cli';

// Platform APIs
import { AI, User, Data, Products, Baskets, Orders, Jobs } from 'lua-cli';

// Utilities
import { env } from 'lua-cli';

// Type definitions
import { BasketStatus, OrderStatus } from 'lua-cli';

// Schema validation
import { z } from 'zod';
```

### Create an Agent (v3.0.0 Pattern)

```typescript
import { LuaAgent, LuaSkill, LuaTool } from 'lua-cli';
import { z } from 'zod';

// Define a tool
class MyTool implements LuaTool {
  name = "my_tool";
  description = "What the tool does";
  inputSchema = z.object({
    param: z.string()
  });

  async execute(input: any) {
    return { result: "success" };
  }
}

// Create a skill
const skill = new LuaSkill({
  name: "my-skill",
  version: "1.0.0",
  description: "My custom skill",
  context: "When to use this skill and its tools",
  tools: [new MyTool()]
});

// Create agent (v3.0.0)
export const agent = new LuaAgent({
  name: "my-agent",
  persona: "You are a helpful assistant...",
  skills: [skill]
});
```

## Core Classes

### Agent Configuration

<CardGroup cols={2}>
  <Card
    title="LuaAgent"
    icon="robot"
    href="/api/luaagent"
  >
    **New in v3.0.0** - Unified agent configuration
    
    ```typescript
    new LuaAgent({
      name: "my-agent",
      persona: "...",
      skills: [...],
      webhooks: [...],
      jobs: [...]
    })
    ```
  </Card>
</CardGroup>

### Building Blocks

<CardGroup cols={2}>
  <Card
    title="LuaSkill"
    icon="puzzle-piece"
    href="/api/luaskill"
  >
    Collection of related tools
    
    ```typescript
    new LuaSkill({
      name: "skill-name",
      tools: [...]
    })
    ```
  </Card>
  <Card
    title="LuaTool"
    icon="wrench"
    href="/api/luatool"
  >
    Individual function the AI can call
    
    ```typescript
    class MyTool implements LuaTool {
      name = "tool_name"
      execute(input) { ... }
    }
    ```
  </Card>
</CardGroup>

### Automation

<CardGroup cols={2}>
  <Card
    title="LuaWebhook"
    icon="webhook"
    href="/api/luawebhook"
  >
    **New in v3.0.0** - HTTP endpoints for external events
    
    ```typescript
    new LuaWebhook({
      name: "payment-webhook",
      execute: async (event) => { ... }
    })
    ```
  </Card>
  <Card
    title="LuaJob"
    icon="clock"
    href="/api/luajob"
  >
    **New in v3.0.0** - Scheduled tasks
    
    ```typescript
    new LuaJob({
      name: "daily-report",
      schedule: { type: "cron", pattern: "0 9 * * *" },
      execute: async (job) => { ... }
    })
    ```
  </Card>
</CardGroup>

### Message Processing

<CardGroup cols={2}>
  <Card
    title="PreProcessor"
    icon="filter"
    href="/api/preprocessor"
  >
    **New in v3.0.0** - Filter messages before agent
    
    ```typescript
    new PreProcessor({
      name: "profanity-filter",
      execute: async (message, user) => { ... }
    })
    ```
  </Card>
  <Card
    title="PostProcessor"
    icon="paper-plane"
    href="/api/postprocessor"
  >
    **New in v3.0.0** - Format responses after agent
    
    ```typescript
    new PostProcessor({
      name: "add-disclaimer",
      execute: async (response, user) => { ... }
    })
    ```
  </Card>
</CardGroup>

## Platform APIs

### AI API

**New!** Generate AI responses with custom context in your tools:

```typescript
import { AI } from 'lua-cli';

const response = await AI.generate(
  'You are a helpful sales assistant.',
  [{ type: 'text', text: 'What products do you recommend?' }]
);
```

**Use cases:**
- Product descriptions
- Image analysis
- Content summarization
- Translation
- Recommendations
- Document Q&A

<Card title="Full Documentation" href="/api/ai" />

### User API

Access current user's information:

```typescript
import { User } from 'lua-cli';

const user = await User.get();
// { id, email, name, ... }
```

<Card title="Full Documentation" href="/api/user" />

### Data API

Custom data storage with vector search:

```typescript
import { Data } from 'lua-cli';

// Create
await Data.create('collection', data, searchText);

// Search semantically
const results = await Data.search('collection', 'query', 10, 0.7);

// Get/Update/Delete
await Data.get('collection', filter);
await Data.update('collection', id, data);
await Data.delete('collection', id);
```

<Card title="Full Documentation" href="/api/data" />

### Products API

E-commerce product catalog:

```typescript
import { Products } from 'lua-cli';

// Search
const products = await Products.search('laptop');

// CRUD
await Products.create({ name, price });
await Products.update({ price }, id);
await Products.getById(id);
await Products.delete(id);
```

<Card title="Full Documentation" href="/api/products" />

### Baskets API

Shopping cart management:

```typescript
import { Baskets, BasketStatus } from 'lua-cli';

// Create basket
const basket = await Baskets.create({ currency: 'USD' });

// Add items
await Baskets.addItem(basket.id, {
  id: productId,
  price: 29.99,
  quantity: 2
});

// Checkout
const order = await Baskets.placeOrder(orderData, basket.id);
```

<Card title="Full Documentation" href="/api/baskets" />

### Orders API

Order processing and tracking:

```typescript
import { Orders, OrderStatus } from 'lua-cli';

// Create order
const order = await Orders.create({
  basketId,
  data: { shippingAddress, paymentMethod }
});

// Update status
await Orders.updateStatus(OrderStatus.FULFILLED, orderId);
```

<Card title="Full Documentation" href="/api/orders" />

### Jobs API

**New in v3.0.0** - Dynamically create scheduled tasks from tools:

```typescript
import { Jobs } from 'lua-cli';

// Create a reminder job
const job = await Jobs.create({
  name: 'user-reminder',
  metadata: { message: 'Meeting in 10 minutes' },
  schedule: {
    type: 'once',
    executeAt: new Date(Date.now() + 600000)
  },
  execute: async (jobInstance) => {
    const user = await jobInstance.user();
    await user.send([{
      type: 'text',
      text: jobInstance.metadata.message
    }]);
  }
});
```

<Card title="Full Documentation" href="/api/jobs" />

## Environment Variables

Secure configuration management:

```typescript
import { env } from 'lua-cli';

const apiKey = env('EXTERNAL_API_KEY');
const baseUrl = env('API_BASE_URL') || 'https://default.com';
```

<Card title="Full Documentation" href="/api/environment" />

## Type Definitions

All APIs are fully typed for TypeScript:

```typescript
import { 
  LuaSkill, 
  LuaTool, 
  BasketStatus, 
  OrderStatus 
} from 'lua-cli';

// Autocomplete and type checking work everywhere
const user = await User.get();  // user is typed
const products = await Products.get(); // products is typed
```

## Common Patterns

### External API Integration

```typescript
export class WeatherTool implements LuaTool {
  name = "get_weather";
  description = "Get current weather";
  inputSchema = z.object({ city: z.string() });

  async execute(input: any) {
    const response = await fetch(
      `https://api.weather.com?city=${input.city}`
    );
    return await response.json();
  }
}
```

### Using Platform APIs

```typescript
export class ShoppingTool implements LuaTool {
  async execute(input: any) {
    // Search products
    const products = await Products.search(input.query);
    
    // Create basket
    const basket = await Baskets.create({ currency: 'USD' });
    
    // Add item
    await Baskets.addItem(basket.id, {
      id: products.data[0].id,
      price: products.data[0].price,
      quantity: 1
    });
    
    return { basketId: basket.id };
  }
}
```

### Custom Data with Search

```typescript
export class CreateNoteTool implements LuaTool {
  async execute(input: any) {
    // Create with search indexing
    const note = await Data.create('notes', {
      title: input.title,
      content: input.content
    }, `${input.title} ${input.content}`);
    
    return { noteId: note.id };
  }
}

export class SearchNotesTool implements LuaTool {
  async execute(input: any) {
    // Semantic search
    const results = await Data.search(
      'notes',
      input.query,
      10,
      0.7
    );
    
    return { notes: results.data };
  }
}
```

## API Reference Pages

### Core Classes

<CardGroup cols={3}>
  <Card title="LuaAgent" href="/api/luaagent" icon="robot">
    **v3.0.0** Agent configuration
  </Card>
  <Card title="LuaSkill" href="/api/luaskill" icon="puzzle-piece">
    Skill class API
  </Card>
  <Card title="LuaTool" href="/api/luatool" icon="wrench">
    Tool interface
  </Card>
  <Card title="LuaWebhook" href="/api/luawebhook" icon="webhook">
    **v3.0.0** HTTP webhooks
  </Card>
  <Card title="LuaJob" href="/api/luajob" icon="clock">
    **v3.0.0** Scheduled tasks
  </Card>
  <Card title="PreProcessor" href="/api/preprocessor" icon="filter">
    **v3.0.0** Message filtering
  </Card>
  <Card title="PostProcessor" href="/api/postprocessor" icon="paper-plane">
    **v3.0.0** Response formatting
  </Card>
</CardGroup>

### Runtime APIs

<CardGroup cols={3}>
  <Card title="AI" href="/api/ai" icon="brain">
    **NEW** AI generation API
  </Card>
  <Card title="User" href="/api/user" icon="user">
    User data API
  </Card>
  <Card title="Data" href="/api/data" icon="database">
    Custom data API
  </Card>
  <Card title="Products" href="/api/products" icon="box">
    Products API
  </Card>
  <Card title="Baskets" href="/api/baskets" icon="cart-shopping">
    Baskets API
  </Card>
  <Card title="Orders" href="/api/orders" icon="receipt">
    Orders API
  </Card>
  <Card title="Jobs" href="/api/jobs" icon="plus">
    **v3.0.0** Jobs API
  </Card>
</CardGroup>

### Utilities

<CardGroup cols={3}>
  <Card title="Environment" href="/api/environment" icon="key">
    Environment utilities
  </Card>
</CardGroup>

## Best Practices

<AccordionGroup>
  <Accordion title="Use TypeScript">
    All APIs are fully typed. Use TypeScript for:
    - Autocomplete
    - Type checking
    - Better IDE support
  </Accordion>

  <Accordion title="Validate Inputs">
    Always use Zod schemas for input validation:
    ```typescript
    inputSchema = z.object({
      email: z.string().email(),
      age: z.number().min(0)
    });
    ```
  </Accordion>

  <Accordion title="Handle Errors">
    Implement proper error handling:
    ```typescript
    try {
      const result = await api.call();
      return result;
    } catch (error) {
      throw new Error(`Operation failed: ${error.message}`);
    }
    ```
  </Accordion>

  <Accordion title="Use Environment Variables">
    Never hardcode secrets:
    ```typescript
    const apiKey = env('API_KEY');
    if (!apiKey) {
      throw new Error('API_KEY not configured');
    }
    ```
  </Accordion>
</AccordionGroup>

## Next Steps

<Steps>
  <Step title="Explore Core Classes">
    Learn about [LuaSkill](/api/luaskill) and [LuaTool](/api/luatool)
  </Step>
  <Step title="Study Platform APIs">
    Explore [User](/api/user), [Data](/api/data), [Products](/api/products), etc.
  </Step>
  <Step title="See Examples">
    Check out [Tool Examples](/examples/overview) for working code
  </Step>
  <Step title="Build Something">
    Follow the [First Skill tutorial](/getting-started/first-skill)
  </Step>
</Steps>

